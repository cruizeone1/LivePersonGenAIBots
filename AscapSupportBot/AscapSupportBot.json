{"id":"seCIqJxXfd8L0GBoGiuc","created_at":1758141472688,"created_by":"5163072938","updated_at":1758141488842,"updated_by":"5163072938","deleted_at":null,"display_name":"AscapDemoBot","version":1,"account_id":"47690390","public":true,"status":"ACTIVE","template":false,"template_group":"community","use_case":"data_collection","cloned_from":null,"cb_tile_metadata":null,"description":"An AI assistant to help ASCAP members with password resets, direct deposit inquiries, and royalty payment disputes.","agent_widget_enabled":false,"agent_widget_skills":[],"nodes":[{"id":"ConcurrentChain-ji3WAB","type":"ConcurrentChain","data":{"input_key":{"show":false,"value":"input"},"output_key":{"show":false,"value":"output"},"memory":{"show":true,"value":null},"post_process_function":{"show":true,"value":"def process_llm_response(llm_results: dict) -> str:\n  extract_variable_response = llm_results['capture_variables']['output']\n  next_question_response = llm_results['get_next_question']['output']\n\n  return f\"{next_question_response}\""},"chain":{"show":true,"value":null}},"position":{"x":997.9541998318068,"y":174.49868472586343},"base_type":"chain","disabled":false},{"id":"ExtractionChain-WCvLBw","type":"ExtractionChain","data":{"name":{"show":true,"value":"capture_variables"},"schema":{"show":true,"value":"{\n  \"properties\": {\n    \"answer\": {\n      \"type\": \"string\",\n      \"description\": \"the value of the variable as identified from the conversation according to the description provided, converted to the format specified\"\n    },\n    \"format\": {\n      \"type\": \"string\",\n      \"description\": \"the format to convert to\"\n    },\n    \"name\": {\n      \"type\": \"string\",\n      \"description\": \"the variable name\"\n    }\n  },\n  \"required\": [\"format\", \"name\"]\n}\n"},"llm":{"show":true,"value":null},"map_to_memory_function":{"show":true,"value":"def map_to_memory(chain_response_schema: list) -> dict[str, str]:\n  memory_dict = {}\n  for item in chain_response_schema:\n    key = item.get('name', None)\n    value = item.get('answer', None)\n    if key is not None and value is not None:\n      memory_dict[key] = value\n\n  return memory_dict"},"memory":{"show":false,"value":null},"prompt_template":{"show":true,"value":null}},"position":{"x":512.3836631154854,"y":-361.0039180756052},"base_type":"chain","disabled":false},{"id":"LLMChain-lAqwbZ","type":"LLMChain","data":{"output_key":{"show":false,"value":"output"},"prompt":{"show":true,"value":null},"llm":{"show":true,"value":null},"memory":{"show":false,"value":null},"save_output":{"show":false,"value":false},"name":{"show":true,"value":"get_next_question"}},"position":{"x":503.1905279995765,"y":191.93423164100795},"base_type":"chain","disabled":false},{"id":"LPPrompt-PpcbLi","type":"LPPrompt","data":{"prompt_library_id":{"show":false,"value":null},"prompt_library_version":{"show":false,"value":null},"input_variables":{"show":false,"value":"conversation_variables_model, primer"},"template":{"show":true,"value":"Your task is to capture the request context variables based on the conversation so far. Only capture variables that can definitely be identified from the conversation\n[PRIMARY_DIRECTIVE]: your task is to populate the unanswered fields in the provided CONTEXT by asking relevant questions until the values for the CONTEXT object is complete. Populate the values of the CONTEXT object using the instructions provided in each property. Continue asking questions until all the required CONTEXT is captured\n[CONTEXT_MODEL]: {conversation_variables_model}\nThe following is an explanation of how to understand the provided CONTEXT: [CONTEXT_DEFINITION]: \n      \"required\": \"states if this is a required question?\",\n      \"name\": \"the name of the variable\",\n      \"question\": \"question that the AI assistant asked\",\n      \"description\": \"some information about the variable to help you formulate your next question\",\n      \"format\": \"the format that the captured value should be converted to\",\n      \"answer\": this is the answer you have captured.\n{primer}\n"}},"position":{"x":106.45656407762908,"y":-314.81507422169494},"base_type":"prompt","disabled":false},{"id":"LPPrompt-srCZvn","type":"LPPrompt","data":{"prompt_library_id":{"show":false,"value":null},"prompt_library_version":{"show":false,"value":null},"input_variables":{"show":false,"value":"conversation_variables_model, primer, persona, rules, task"},"template":{"show":true,"value":"[PRIMARY_DIRECTIVE]: Your key objective is to populate the answers in CONTEXT (i.e. answer all the questions listed) by asking the user interrogative questions (1 question at a time, and make sure that you never mention the question number) until all required questions have been answered.\n[VARIABLES_TO_CAPTURE]: {conversation_variables_model}\n[PRIMER]: {primer}\n[PERSONA]: your personality can be described as {persona}\n[RULES]: as the AI assistant, you always adhere to the following rules:\n- do not tell the user how they should respond\n- do not tell the user what format they should respond with\n- the user can respond however they wish, as long as their response is valid and answers your question. For example, you should NEVER tell the customer to provide a date in 'DD-MM-YYY', just ask for the date and accept a valid response, such as 'yesterday', '2 weeks ago', 'tomorrow', etc.\n- do not respond with statements such as \"Please answer the following questions\", instead, just ask your question\n- only ask one question at a time, do not ask the user multiple questions unless explicitly stated in the CONTEXT property\n- always ask questions in the order shown in CONTEXT\n\nEnsure you follow the above rules precisely when formulating your response, and never deviate from the above instructions.  In addition to the above rules:\n- do not respond with numbered lists\n- imagine you are speaking to the user verbally, do not mention the question numbers. Simply state the question without numbering the question.\n- do not, under any circumstances, number the questions. For example, if the customer started the conversation by saying 'I want to book a flight', you might say: 'great, what day would you like to fly?\n{rules}\n[TASK]: Your task is to gather information from the user in order to: {task}, by asking questions sequentially in the order displayed in VARIABLES_TO_CAPTURE"}},"position":{"x":102.02703871021845,"y":124.14063824916599},"base_type":"prompt","disabled":false},{"id":"LPContextualMemory-rqaQ23","type":"LPContextualMemory","data":{"context_vars_key_map":{"show":true,"value":{}},"llm":{"show":false,"value":null},"conversational_slot_key_list":{"show":false,"value":"primary_intent,member_email,direct_deposit_guidance,member_id,distribution_quarter"},"max_turns":{"show":false,"value":-1},"conversational_slot_key_map":{"show":true,"value":{"member_email":{"description":"The member's email address for account verification and sending the password reset link.","additional_keys":"{\"required\":true,\"format\":\"email\",\"sample_question\":\"I can help with that. To reset your password, please provide the email address associated with your ASCAP account.\",\"exit\":\"Great. I've sent a password reset link to your email. Please check your inbox and spam folder and follow the instructions to create a new password.\"}"},"primary_intent":{"description":"The user's primary goal (e.g., Password Reset, Update Direct Deposit, Royalty Dispute).","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Hello! I'm the ASCAP Member Support Assistant. How can I help you today? You can say things like 'I need to reset my password', 'update my bank info', or 'I have an issue with my royalty payment'.\",\"exit\":\"\"}"},"distribution_quarter":{"description":"The specific royalty distribution quarter the member is disputing (e.g., Q2 2025).","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Thank you. And which specific distribution quarter are you concerned about (e.g., Q2 2025)?\",\"exit\":\"Thank you. I have created a support ticket for you with your Member ID and the distribution quarter. A member of our Royalty Services team will carefully review your account and contact you directly via email within 3-5 business days to resolve this.\"}"},"member_id":{"description":"The member's unique ASCAP Member ID for royalty dispute investigation.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"I understand your concern about your royalty payment, and I'm sorry to hear it doesn't look right. To speed things up, could you please provide me with your ASCAP Member ID?\",\"exit\":\"\"}"},"direct_deposit_guidance":{"description":"A confirmation slot that is filled by providing guidance on how to update direct deposit information securely.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"I can certainly point you in the right direction to update your direct deposit information. For your security, banking details must be updated directly by you inside your secure Member Access portal. Please log in to your Member Access account and navigate to the 'Payment Information' section in your profile to make the changes. Were you able to find it, or do you need more help?\",\"exit\":\"\"}"}}},"memory_key":{"show":false,"value":"chat_history"},"dynamic_vars_key_map":{"show":true,"value":{"current_time":{"test_value":"","dynamic_var_name":"current_datetime"}}},"static_vars_key_map":{"show":true,"value":{"persona":{"metadata":"{}","value":"You are a professional, secure, and empathetic support agent. Your tone should be helpful and clear, inspiring confidence and trust."},"rules":{"metadata":"{}","value":"- Security First: Never ask for, receive, or store sensitive personal information such as passwords or bank account numbers. Always redirect users to the secure portal for such tasks.\\n- Password Reset Process: For password resets, the only piece of information you will collect is the user's email address to trigger the reset link API.\\n- Direct Deposit Guidance: When a user asks to update banking information, your only action is to explain the security policy and direct them to the 'Payment Information' section of the Member Access portal.\\n- Royalty Dispute Escalation: 1. Immediately recognize any user phrase indicating a payment error as a high-priority issue. 2. Acknowledge the user's concern with empathy. 3. State clearly that you will connect them with a specialist. 4. Before escalating, you must collect two pieces of information: the ASCAP Member ID and the specific distribution quarter in question. 5. After collecting the details, confirm that a support ticket has been created and set the expectation of a response from the Royalty Services team within 3-5 business days."},"task":{"metadata":"{}","value":"To provide self-service for common ASCAP member inquiries, offer clear guidance for secure tasks, and intelligently escalate complex issues to the appropriate human support team."}}}},"position":{"x":1000.5902360795944,"y":673.3883925430057},"base_type":"memory","disabled":false},{"id":"LPLLMGateway-dgFf2j","type":"LPLLMGateway","data":{"llm_mode":{"show":true,"value":"chat"},"openai_model_name":{"show":true,"value":"gpt-3.5-turbo"},"api_version":{"show":false,"value":"2024-02-15-preview"},"cohere_model_name":{"show":true,"value":"command"},"top_p":{"show":false,"value":1},"llm_provider":{"show":true,"value":"openai-azure"},"max_tokens":{"show":false,"value":-1},"subscription_name":{"show":true,"value":"ai-studio"},"openai_azure_model_name":{"show":true,"value":"gpt-4o-mini"},"temperature":{"show":false,"value":0}},"position":{"x":-212.56359664438196,"y":-373.3121504708811},"base_type":"llm","disabled":false},{"id":"LPLLMGateway-SlHnub","type":"LPLLMGateway","data":{"llm_mode":{"show":true,"value":"chat"},"openai_model_name":{"show":true,"value":"gpt-3.5-turbo"},"api_version":{"show":false,"value":"2024-02-15-preview"},"cohere_model_name":{"show":true,"value":"command"},"top_p":{"show":false,"value":1},"llm_provider":{"show":true,"value":"openai-azure"},"max_tokens":{"show":false,"value":-1},"subscription_name":{"show":true,"value":"ai-studio"},"openai_azure_model_name":{"show":true,"value":"gpt-4o"},"temperature":{"show":false,"value":0}},"position":{"x":-220.56359664438196,"y":126.68784952911892},"base_type":"llm","disabled":false}],"edges":[{"id":"Edge-l0huyO","source":"ExtractionChain-WCvLBw","target":"ConcurrentChain-ji3WAB","sourceHandle":"output","targetHandle":"chain","disabled":false},{"id":"Edge-a6v2Oa","source":"LLMChain-lAqwbZ","target":"ConcurrentChain-ji3WAB","sourceHandle":"output","targetHandle":"chain","disabled":false},{"id":"Edge-75Rn6a","source":"LPPrompt-PpcbLi","target":"ExtractionChain-WCvLBw","sourceHandle":"output","targetHandle":"prompt_template","disabled":false},{"id":"Edge-yhdxjI","source":"LPPrompt-srCZvn","target":"LLMChain-lAqwbZ","sourceHandle":"output","targetHandle":"prompt","disabled":false},{"id":"Edge-AHcF2a","source":"LPContextualMemory-rqaQ23","target":"ConcurrentChain-ji3WAB","sourceHandle":"output","targetHandle":"memory","disabled":false},{"id":"Edge-klBxoK","source":"LPLLMGateway-dgFf2j","target":"ExtractionChain-WCvLBw","sourceHandle":"output","targetHandle":"llm","disabled":false},{"id":"Edge-F6bra4","source":"LPLLMGateway-SlHnub","target":"LLMChain-lAqwbZ","sourceHandle":"output","targetHandle":"llm","disabled":false}],"use_case_mapping":{"data_collection":{"memory_node_id":"LPContextualMemory-rqaQ23"}},"jobs":{}}