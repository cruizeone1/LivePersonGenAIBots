{"id":"HIWN4gTPxfe8yNoKaRyl","created_at":1755717728438,"created_by":"5163072938","updated_at":1758204815087,"updated_by":"5163072938","deleted_at":null,"display_name":"Fraud Use Case","version":1,"account_id":"47690390","public":true,"status":"ACTIVE","template":false,"template_group":"community","use_case":"data_collection","cloned_from":null,"cb_tile_metadata":null,"description":"An AI assistant that owns and resolves customer issues, including fraud investigations and damaged product complaints.","agent_widget_enabled":false,"agent_widget_skills":[],"nodes":[{"id":"ConcurrentChain-42oJm2","type":"ConcurrentChain","data":{"input_key":{"show":false,"value":"input"},"post_process_function":{"show":true,"value":"def process_llm_response(llm_results: dict) -> str:\n  extract_variable_response = llm_results['capture_variables']['output']\n  next_question_response = llm_results['get_next_question']['output']\n\n  return f\"{next_question_response}\""},"memory":{"show":true,"value":null},"output_key":{"show":false,"value":"output"},"chain":{"show":true,"value":null}},"position":{"x":997.9541998318068,"y":174.49868472586343},"base_type":"chain","disabled":false},{"id":"ExtractionChain-paezHE","type":"ExtractionChain","data":{"name":{"show":true,"value":"capture_variables"},"schema":{"show":true,"value":"{\n  \"properties\": {\n    \"answer\": {\n      \"type\": \"string\",\n      \"description\": \"the value of the variable as identified from the conversation according to the description provided, converted to the format specified\"\n    },\n    \"format\": {\n      \"type\": \"string\",\n      \"description\": \"the format to convert to\"\n    },\n    \"name\": {\n      \"type\": \"string\",\n      \"description\": \"the variable name\"\n    }\n  },\n  \"required\": [\"format\", \"name\"]\n}\n"},"memory":{"show":false,"value":null},"llm":{"show":true,"value":null},"map_to_memory_function":{"show":true,"value":"def map_to_memory(chain_response_schema: list) -> dict[str, str]:\n  memory_dict = {}\n  for item in chain_response_schema:\n    key = item.get('name', None)\n    value = item.get('answer', None)\n    if key is not None and value is not None:\n      memory_dict[key] = value\n\n  return memory_dict"},"prompt_template":{"show":true,"value":null}},"position":{"x":512.3836631154854,"y":-361.0039180756052},"base_type":"chain","disabled":false},{"id":"LLMChain-yRXZJi","type":"LLMChain","data":{"output_key":{"show":false,"value":"output"},"save_output":{"show":false,"value":false},"memory":{"show":false,"value":null},"llm":{"show":true,"value":null},"prompt":{"show":true,"value":null},"name":{"show":true,"value":"get_next_question"}},"position":{"x":503.1905279995765,"y":191.93423164100795},"base_type":"chain","disabled":false},{"id":"LPPrompt-uKGnwI","type":"LPPrompt","data":{"prompt_library_id":{"show":false,"value":null},"prompt_library_version":{"show":false,"value":null},"input_variables":{"show":false,"value":"conversation_variables_model, primer"},"template":{"show":true,"value":"Your task is to capture the request context variables based on the conversation so far. Only capture variables that can definitely be identified from the conversation\n[PRIMARY_DIRECTIVE]: your task is to populate the unanswered fields in the provided CONTEXT by asking relevant questions until the values for the CONTEXT object is complete. Populate the values of the CONTEXT object using the instructions provided in each property. Continue asking questions until all the required CONTEXT is captured\n[CONTEXT_MODEL]: {conversation_variables_model}\nThe following is an explanation of how to understand the provided CONTEXT: [CONTEXT_DEFINITION]: \n      \"required\": \"states if this is a required question?\",\n      \"name\": \"the name of the variable\",\n      \"question\": \"question that the AI assistant asked\",\n      \"description\": \"some information about the variable to help you formulate your next question\",\n      \"format\": \"the format that the captured value should be converted to\",\n      \"answer\": this is the answer you have captured.\n{primer}\n"}},"position":{"x":106.45656407762908,"y":-314.81507422169494},"base_type":"prompt","disabled":false},{"id":"LPPrompt-D35Jby","type":"LPPrompt","data":{"prompt_library_id":{"show":false,"value":null},"prompt_library_version":{"show":false,"value":null},"input_variables":{"show":false,"value":"conversation_variables_model, primer, persona, rules, task"},"template":{"show":true,"value":"[PRIMARY_DIRECTIVE]: Your key objective is to populate the answers in CONTEXT (i.e. answer all the questions listed) by asking the user interrogative questions (1 question at a time, and make sure that you never mention the question number) until all required questions have been answered.\n[VARIABLES_TO_CAPTURE]: {conversation_variables_model}\n[PRIMER]: {primer}\n[PERSONA]: your personality can be described as {persona}\n[RULES]: as the AI assistant, you always adhere to the following rules:\n- do not tell the user how they should respond\n- do not tell the user what format they should respond with\n- the user can respond however they wish, as long as their response is valid and answers your question. For example, you should NEVER tell the customer to provide a date in 'DD-MM-YYY', just ask for the date and accept a valid response, such as 'yesterday', '2 weeks ago', 'tomorrow', etc.\n- do not respond with statements such as \"Please answer the following questions\", instead, just ask your question\n- only ask one question at a time, do not ask the user multiple questions unless explicitly stated in the CONTEXT property\n- always ask questions in the order shown in CONTEXT\n\nEnsure you follow the above rules precisely when formulating your response, and never deviate from the above instructions.  In addition to the above rules:\n- do not respond with numbered lists\n- imagine you are speaking to the user verbally, do not mention the question numbers. Simply state the question without numbering the question.\n- do not, under any circumstances, number the questions. For example, if the customer started the conversation by saying 'I want to book a flight', you might say: 'great, what day would you like to fly?\n{rules}\n[TASK]: Your task is to gather information from the user in order to: {task}, by asking questions sequentially in the order displayed in VARIABLES_TO_CAPTURE"}},"position":{"x":102.02703871021845,"y":124.14063824916599},"base_type":"prompt","disabled":false},{"id":"LPContextualMemory-YLCk0A","type":"LPContextualMemory","data":{"context_vars_key_map":{"show":true,"value":{}},"llm":{"show":false,"value":null},"conversational_slot_key_list":{"show":false,"value":"primary_intent,fraud_dob,fraud_address,fraud_pin,fraud_lender_name,fraud_account_details,fraud_open_date,retail_full_name,retail_order_number,retail_email,retail_damage_photo"},"max_turns":{"show":false,"value":-1},"conversational_slot_key_map":{"show":true,"value":{"retail_order_number":{"description":"The order number for the damaged item.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Thank you. What is the order number?\",\"exit\":\"\"}"},"retail_email":{"description":"The email address used to place the order.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"And the email address you used to place the order?\",\"exit\":\"\"}"},"fraud_open_date":{"description":"The date the fraudulent account was opened.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"What date does it show the account was opened?\",\"exit\":\"\"}"},"fraud_pin":{"description":"The user's account PIN for verification.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Finally, please provide the account PIN you set up for security.\",\"exit\":\"\"}"},"fraud_account_details":{"description":"The account number or partial number of the unrecognized account.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"And do you have the account number, or even the last few digits?\",\"exit\":\"\"}"},"retail_full_name":{"description":"The user's full name for order lookup.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"I'm sorry to hear that. I'll get this sorted out. To pull up your order, could you please confirm your full name?\",\"exit\":\"\"}"},"fraud_address":{"description":"The user's current home address for verification.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"And what is the current home address on file?\",\"exit\":\"\"}"},"primary_intent":{"description":"The customer's primary goal (e.g., Report Fraud, Report Damaged Item).","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Thank you for contacting us. To get started, could you please tell me if you're here to report a potential fraud issue or a problem with a damaged item you received?\",\"exit\":\"\"}"},"fraud_dob":{"description":"The user's full date of birth for verification.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Thank you. To securely pull up your account, could you please confirm your full date of birth?\",\"exit\":\"\"}"},"retail_damage_photo":{"description":"Confirmation that the user can provide a photo of the damage.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Okay, I've found your order. To fast-track your replacement, could you upload a photo of the damage?\",\"exit\":\"\"}"},"fraud_lender_name":{"description":"The name of the lender for the unrecognized account.","additional_keys":"{\"required\":true,\"format\":\"\",\"sample_question\":\"Okay, you're verified. Now, let's identify the account in question. What is the lender's name showing on your report?\",\"exit\":\"\"}"}}},"memory_key":{"show":false,"value":"chat_history"},"dynamic_vars_key_map":{"show":true,"value":{"current_time":{"test_value":"","dynamic_var_name":"current_datetime"}}},"static_vars_key_map":{"show":true,"value":{"persona":{"metadata":"{}","value":"The bot is a Resolution Specialist. It acts as a single point of contact that owns customer issues from initial report to final resolution. It is empathetic, reassuring, accountable, professional, clear, and proactive."},"rules":{"metadata":"{}","value":"- Always begin interactions by verifying the customer's identity before accessing or discussing account details.\n- Methodically gather all necessary details about the issue.\n- Provide a unique case ID for every investigation or complaint.\n- Set clear timelines for resolution.\n- Explicitly state when the next follow-up will occur.\n- For damaged product returns, clarify that there will be no cost to the customer.\n- When fraud is suspected, instruct the customer on immediate protective measures."},"task":{"metadata":"{}","value":"To manage and resolve two primary use cases: 1. Fraud Investigation for financial services, and 2. Damaged Product Resolution for retail. The bot will guide the user through authentication, case intake, and resolution steps, providing clear timelines and reference numbers."}}}},"position":{"x":1000.5902360795944,"y":673.3883925430057},"base_type":"memory","disabled":false},{"id":"LPLLMGateway-rolQ2w","type":"LPLLMGateway","data":{"llm_mode":{"show":true,"value":"chat"},"openai_model_name":{"show":true,"value":"gpt-3.5-turbo"},"cohere_model_name":{"show":true,"value":"command"},"api_version":{"show":false,"value":"2024-10-21"},"top_p":{"show":false,"value":1},"llm_provider":{"show":true,"value":"openai-azure"},"max_tokens":{"show":false,"value":-1},"subscription_name":{"show":true,"value":"ai-studio"},"openai_azure_model_name":{"show":true,"value":"gpt-4o-mini-2024-07-18"},"temperature":{"show":false,"value":0}},"position":{"x":-212.56359664438196,"y":-373.3121504708811},"base_type":"llm","disabled":false},{"id":"LPLLMGateway-G17YBG","type":"LPLLMGateway","data":{"llm_mode":{"show":true,"value":"chat"},"openai_model_name":{"show":true,"value":"gpt-3.5-turbo"},"cohere_model_name":{"show":true,"value":"command"},"api_version":{"show":false,"value":"2024-10-21"},"top_p":{"show":false,"value":1},"llm_provider":{"show":true,"value":"openai-azure"},"max_tokens":{"show":false,"value":-1},"subscription_name":{"show":true,"value":"ai-studio"},"openai_azure_model_name":{"show":true,"value":"gpt-4o-mini-2024-07-18"},"temperature":{"show":false,"value":0}},"position":{"x":-220.56359664438196,"y":126.68784952911892},"base_type":"llm","disabled":false}],"edges":[{"id":"Edge-9I8wBP","source":"ExtractionChain-paezHE","target":"ConcurrentChain-42oJm2","sourceHandle":"output","targetHandle":"chain","disabled":false},{"id":"Edge-rr7KuO","source":"LLMChain-yRXZJi","target":"ConcurrentChain-42oJm2","sourceHandle":"output","targetHandle":"chain","disabled":false},{"id":"Edge-lM6mXZ","source":"LPPrompt-uKGnwI","target":"ExtractionChain-paezHE","sourceHandle":"output","targetHandle":"prompt_template","disabled":false},{"id":"Edge-UTu9xJ","source":"LPPrompt-D35Jby","target":"LLMChain-yRXZJi","sourceHandle":"output","targetHandle":"prompt","disabled":false},{"id":"Edge-wVtsyt","source":"LPContextualMemory-YLCk0A","target":"ConcurrentChain-42oJm2","sourceHandle":"output","targetHandle":"memory","disabled":false},{"id":"Edge-a6dR4D","source":"LPLLMGateway-rolQ2w","target":"ExtractionChain-paezHE","sourceHandle":"output","targetHandle":"llm","disabled":false},{"id":"Edge-EAaI9Q","source":"LPLLMGateway-G17YBG","target":"LLMChain-yRXZJi","sourceHandle":"output","targetHandle":"llm","disabled":false}],"use_case_mapping":{"data_collection":{"memory_node_id":"LPContextualMemory-YLCk0A"}},"jobs":{}}